<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Abacus Random Number Generator</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
  <style>
    body {
      text-align: center;
      height: 100vh;
      font-family: 'Roboto';
    }

    #output {
      font-size: 200px;
      padding-top: 100px;
      color: black;
      /* transition: opacity 0.5s ease-in-out; */
    }

    #output.final-result {
      color: green;
    }

    #startBtn,
    #stopBtn,
    #resetBtn,
    #answerBtn {
      font-size: 1.5em;
      padding: 10px;
      cursor: pointer;
    }

    .btns {
      display: flex;
      justify-content: space-around;
      padding-top: 150px;
    }

    .btnstyl1 {
      background: #4CAF50;
      border: none;
      color: white;
      padding: 35px 30px !important;
      border-radius: 50%;
      box-shadow: 5px 2px 12px #c5c5c5;
    }

    .btnstyl2 {
      background: #f44336;
      border: none;
      color: white;
      padding: 35px 30px !important;
      border-radius: 50%;
      box-shadow: 5px 2px 12px #c5c5c5;
    }

    .btnstyl3 {
      background: #2196F3;
      border: none;
      color: white;
      border-radius: 50%;
      padding: 35px 25px !important;
      box-shadow: 5px 2px 12px #c5c5c5;
    }

    .btnstyl4 {
      background: #FF9800;
      border: none;
      color: white;
      padding: 35px 18px !important;
      border-radius: 50%;
      box-shadow: 5px 2px 12px #c5c5c5;
    }

    .set-time {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .set-time img {
      width: 100px;
    }
    .d-none{
      display:none ;
    }
    input[type="number"]{
      height: 40px;
    padding: 0px 25px;
    border: 1px solid #c6c6c6;
    border-radius: 5px;
    }
    label{
      font-size: 22px;
    }
    .set{
      height: 40px;
      background-color: #f44336;
      border-radius: 5px;
      border: none;
      color: #fff;
      border: 3px solid rgb(255 173 173);
    border-style: groove;
    box-shadow: 2px 3px 4px #d1d1d1;
    }
    .set:focus .d-none{
      display: none !important;
    }
  </style>
</head>

<body>
  <div id="output" class="screen">0</div>
  <div class="btns">
    <button id="startBtn" class="btnstyl1" onclick="startTimer()">Start</button>
    <button id="stopBtn" class="btnstyl2" onclick="stopTimer()">Stop</button>
    <button id="resetBtn" class="btnstyl3" onclick="resetProgram()">Reset</button>
    <button id="answerBtn" class="btnstyl4" onclick="showAnswer()">Answer</button>


  </div>
  <div class="set-time">
    <a href="#" id="stopwatchLink"><img src="image/stopwatch.png" alt=""></a>
    <div class="d-none" id="speedDiv">
        <label for="speedInput">Speed: </label>
        <input type="number" id="speedInput" min="1" max="5" value="1">
        <button class="set" id="setButton">SET</button>
    </div>
</div>

  <script>
    let timerId;
    let result = 0;
    let isTimerRunning = false;
    let transitionSpeed = 3000; // Default speed in milliseconds (3 seconds)
    let negativeCount = 0;
    let generationCount = 0;

    function startTimer() {
      if (!isTimerRunning) {
        displayRandomNumber();
        timerId = setInterval(displayRandomNumber, transitionSpeed);
        isTimerRunning = true;
      }
    }

    function stopTimer() {
      clearInterval(timerId);
      isTimerRunning = false;
    }

    function resetProgram() {
      clearInterval(timerId);
      result = 0;
      const output = document.getElementById('output');
      output.style.opacity = 1;
      output.classList.remove('final-result');
      output.innerHTML = '0';
      isTimerRunning = false;
      negativeCount = 0;
      generationCount = 0;
    }

    function displayRandomNumber() {
      if (isTimerRunning) {
        const randomNumber = generateRandomNumber();

        const output = document.getElementById('output');
        output.style.opacity = 0;

        setTimeout(() => {
          output.textContent = randomNumber;
          output.style.opacity = 1;
        }, transitionSpeed);

        result = calculateResult(result, '+', randomNumber);

        generationCount++;

        if (generationCount === 15) {
          // Reset the counts after 15 generations
          negativeCount = 0;
          generationCount = 0;
        }
      }
    }

    function generateRandomNumber() {
      let randomNumber;
      if (generationCount < 2) {
        // Ensure the first two numbers are positive
        randomNumber = Math.floor(Math.random() * 100);
      } else {
        // Allow negative numbers between -1 and -20 after the first two positive numbers
        randomNumber = Math.floor(Math.random() * 20) + 1;
        randomNumber *= Math.random() < 0.5 ? -1 : 1;

        // Increment negative count if a negative number is generated
        if (randomNumber < 0) {
          negativeCount++;
        }

        // Ensure only 2 occurrences of negative numbers in 15 generations
        if (negativeCount > 2) {
          randomNumber = Math.abs(randomNumber);
        }
      }

      return randomNumber;
    }

    function calculateResult(currentResult, symbol, number) {
      return currentResult + number;
    }

    function showAnswer() {
      const output = document.getElementById('output');
      output.classList.add('final-result');
      output.innerHTML = result;
      setTimeout(() => {
        output.style.opacity = 1;
      }, transitionSpeed);
    }

    function adjustSpeed(value) {
      transitionSpeed = value * 1000; // Convert value to milliseconds
      if (isTimerRunning) {
        clearInterval(timerId);
        timerId = setInterval(displayRandomNumber, transitionSpeed);
      }
    }

    // Event listener for input changes
    document.getElementById('speedInput').addEventListener('change', function () {
      const speedValue = parseInt(this.value, 10);
      adjustSpeed(speedValue);
    });




    // stop-watch
    var speedDiv = document.getElementById('speedDiv');
    var stopwatchLink = document.getElementById('stopwatchLink');
    var setButton = document.getElementById('setButton');

    stopwatchLink.addEventListener('click', function() {
        speedDiv.classList.remove('d-none');
    });

    setButton.addEventListener('click', function() {
        speedDiv.classList.add('d-none');
    });
  </script>










</body>

</html>